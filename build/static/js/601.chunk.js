"use strict";(self.webpackChunkexodus_crm=self.webpackChunkexodus_crm||[]).push([[601],{5601:function(e,a,n){n.r(a),n.d(a,{default:function(){return Z}});var l=n(4165),t=n(5861),r=n(9439),i=n(7313),s=n(249),u=n(4205),o=n(4254),c=n(7415),d=n(6417),m=function(e){var a=(0,o.zQ)({team_id:e.teamId}).data,n=void 0===a?[]:a,l=i.useState([]),t=(0,r.Z)(l,2),s=t[0],m=t[1];return i.useEffect((function(){m(null===n||void 0===n?void 0:n.map((function(e){return{value:e.id,label:e.username}})))}),[n]),(0,d.jsxs)("label",{className:"flex flex-col gap-1 mb-4 ".concat(void 0===e.labelClass?"":e.labelClass).trim(),htmlFor:"user",children:["User",(0,d.jsx)(u.ZP,{isClearable:!0,options:s,styles:c.Z,placeholder:null===e.placeholder?"":e.placeholder,value:null===e.user?"":e.user,onChange:e.onChange})]})},f=n(8741),h=n(3433),p=n(507),v=n(8645),x=function(e){var a=(0,o.k3)().data,n=void 0===a?[]:a,s=i.useState([]),m=(0,r.Z)(s,2),x=m[0],b=m[1],g=i.useState([]),Z=(0,r.Z)(g,2),S=Z[0],j=Z[1],y=i.useState(10),C=(0,r.Z)(y,2),k=C[0],_=C[1],N=(0,o.h8)(),D=(0,r.Z)(N,2),w=D[0],V=D[1],E=i.useState([]),O=(0,r.Z)(E,2),P=O[0],A=O[1],T=i.useState([]),z=(0,r.Z)(T,2),L=z[0],I=z[1];i.useEffect((function(){var e=[];n.forEach((function(a){return e.push({value:a,label:a})})),b(e)}),[n]);i.useEffect((function(){var a=setTimeout((0,t.Z)((0,l.Z)().mark((function a(){return(0,l.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!(0===e.domainSearchValue.trim().length||k<1||0===S.length||null===e.team_id)){a.next=2;break}return a.abrupt("return");case 2:return I([]),A([]),a.next=6,w({team_id:e.team_id,q:e.domainSearchValue,zones:S,max_price:k,quantity:3}).then((function(e){A(e.data)}));case 6:case"end":return a.stop()}}),a)}))),500);return function(){return clearTimeout(a)}}),[S,k,e.domainSearchValue,e.team_id,w]);return(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,d.jsx)(f.Z,{id:"domain_search",type:"text",label:"Domain search",placeholder:"Type here domain name...",className:"flex-grow",value:void 0===e.domainSearchValue?"test crypto cart":e.domainSearchValue,changeValue:void 0===e.setDomainSearchValue?function(){}:e.setDomainSearchValue}),(0,d.jsx)(f.Z,{id:"max_price",type:"number",label:"Max domain price",placeholder:"Type price here",className:"md:w-[150px]",value:k,changeValue:function(e){_(e.target.value)}}),(0,d.jsxs)("label",{className:"flex flex-col gap-1 mb-4 md:w-[200px]",htmlFor:"team",children:["Domain zone",(0,d.jsx)(u.ZP,{isClearable:!0,isMulti:!0,options:x,styles:c.Z,placeholder:"Select zones...",onChange:function(e){var a=[];e.forEach((function(e){return a.push(e.value)})),j(a)}})]})]}),V.isLoading?(0,d.jsx)(p.Z,{}):void 0!==P&&P.length?(0,d.jsx)("div",{className:"flex flex-col gap-4",children:P.map((function(e){return(0,d.jsxs)(v.Z,{className:!1===e.is_available?"opacity-60":"",children:[(0,d.jsx)("input",{value:e.domain,type:"checkbox",onChange:function(e){return function(e){var a=e.checked,n=e.value;I(a?function(e){return[].concat((0,h.Z)(e),[n])}:function(e){return e.filter((function(e){return e!==n}))})}(e.target)}}),JSON.stringify(e)]},e.domain)}))}):null,void 0!==L&&L.length?(0,d.jsx)("button",{onClick:function(){var a=typeof e.onSetupDomainsCallback;"function"===a?e.onSetupDomainsCallback({selectedDomains:L,domainsSearchResult:P,maxDomainPrice:k}):console.error("props.onSetupDomainsCallback should be a function, ".concat(a," given"))},className:"btn-primary mt-4",children:"Setup domains"}):null]})},b=function(e){var a=(0,o.xH)().data,n=void 0===a?[]:a,l=i.useState([]),t=(0,r.Z)(l,2),s=t[0],m=t[1];return i.useEffect((function(){Array.isArray(n)&&m(n.map((function(e){return{value:e.id,label:e.ip_address}})))}),[n]),(0,d.jsx)(u.ZP,{isClearable:!0,options:s,styles:c.Z,placeholder:"Select ip address...",onChange:e.onChange})},g=n(4491),Z=function(e){var a={balance:0,currency:"USD"},n=i.useState({}),u=(0,r.Z)(n,2),c=u[0],h=u[1],Z=i.useState({}),S=(0,r.Z)(Z,2),j=S[0],y=S[1],C=i.useState(a),k=(0,r.Z)(C,2),_=k[0],N=k[1],D=i.useState(10),w=(0,r.Z)(D,2),V=w[0],E=w[1],O=i.useState(""),P=(0,r.Z)(O,2),A=P[0],T=P[1],z=void 0===c||null===c||void 0===c.value,L=(0,o.L7)({team:z?0:c.value},{skip:z}).data,I=(0,o.rf)(),J=(0,r.Z)(I,2),q=J[0],F=J[1],M=i.useState([]),U=(0,r.Z)(M,2),B=U[0],H=U[1],Q=i.useState({}),R=(0,r.Z)(Q,2),G=R[0],K=R[1];i.useEffect((function(){null!==c&&N(L)}),[L,c]);var W=function(){var e=(0,t.Z)((0,l.Z)().mark((function e(){var a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],Object.entries(G).forEach((function(e){var n=(0,r.Z)(e,2),l=n[0],t=n[1];a.push({name:l,vps_id:t})})),e.next=4,q({team_id:c.value,user_id:j.value,max_price:V,domains:a}).then((function(e){void 0===e.error?g.Am.success("Domains setup in progress"):void 0!==e.error.data.detail?g.Am.error(e.error.data.detail):g.Am.error(e.error.data.message)}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:B.length?"hidden":null,children:[(0,d.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,d.jsx)(s.Z,{labelClass:"flex-grow",placeholder:(null===c||void 0===c.label)&&"No team",team:null===c||void 0===c.label?null:c,onChange:function(e){h(e),y(null),null===e&&N(a)}}),(0,d.jsx)(m,{labelClass:"md:w-[200px]",teamId:null===c?null:c.value,user:null===j||void 0===j.label?null:j,placeholder:(null===j||void 0===j.label)&&"No user",onChange:function(e){return y(e)}})]}),(0,d.jsx)(f.Z,{label:"Balance",id:"team_balance",placeholder:null===c||void 0===c.label?"Team balance":"".concat(c.label," balance"),type:"text",readOnly:!0,value:void 0===_?"":"".concat(_.balance," ").concat(_.currency)}),(0,d.jsx)(x,{team_id:null===c||void 0===c.value?null:c.value,domainSearchValue:A,setDomainSearchValue:function(e){void 0!==T&&T(e.target.value)},onSetupDomainsCallback:function(e){H(e.selectedDomains),E(e.maxDomainPrice)}})]}),B.length?(0,d.jsxs)("div",{children:[B.map((function(e){return(0,d.jsxs)(v.Z,{children:[(0,d.jsxs)("div",{children:["Domain: ",e]}),(0,d.jsxs)("div",{className:"flex gap-3 items-center mt-2",children:["IP address:",(0,d.jsx)(b,{onChange:function(a){!function(e,a){var n=JSON.parse(JSON.stringify(G));void 0===a||null===a?delete n[e]:n[e]=a.value,K(n)}(e,a)}})]})]},e)})),B.length===Object.keys(G).length&&!1===F.isLoading&&(0,d.jsx)("button",{onClick:W,className:"btn-primary mt-4",children:"Setup domains"}),F.isLoading?(0,d.jsx)(p.Z,{}):null]}):null]})}}}]);